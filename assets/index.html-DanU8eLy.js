import{_ as s,c as i,a as e,o as n}from"./app-B8grFKEw.js";const r={};function t(l,a){return n(),i("div",null,a[0]||(a[0]=[e(`<h2 id="将lanraragi改为用另一台主机运行后出现redis数据加载问题" tabindex="-1"><a class="header-anchor" href="#将lanraragi改为用另一台主机运行后出现redis数据加载问题"><span>将lanraragi改为用另一台主机运行后出现Redis数据加载问题</span></a></h2><p>原本lanraragi运行在nas上，由于近期新装了一台Mini主机作服务器，便想将服务和存储分离。在新主机上使用docker-compose拉取lanraragi的镜像出现以下错误</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>lanraragi  | Can&#39;t load application from file &quot;/home/koyomi/lanraragi/script/lanraragi&quot;: Error while reading from Redis server: Connection reset by peer at /usr/local/share/perl5/site_perl/Redis.pm line 321.</span></span>
<span class="line"><span>lanraragi  | 	...propagated at /home/koyomi/lanraragi/script/../lib/LANraragi.pm line 88.</span></span>
<span class="line"><span>lanraragi  | Server PID will be at /home/koyomi/lanraragi/temp/server.pid</span></span>
<span class="line"><span>lanraragi  | </span></span>
<span class="line"><span>lanraragi  | </span></span>
<span class="line"><span>lanraragi  | ｷﾀ━━━━━━(ﾟ∀ﾟ)━━━━━━!!!!!</span></span>
<span class="line"><span>lanraragi  | (╯・_&gt;・）╯︵ ┻━┻</span></span>
<span class="line"><span>lanraragi  | It appears your Redis database is currently not running.</span></span>
<span class="line"><span>lanraragi  | The program will cease functioning now.</span></span>
<span class="line"><span>lanraragi  | cat: can&#39;t open &#39;/home/koyomi/lanraragi/temp/shinobu.pid-s6&#39;: No such file or directory</span></span>
<span class="line"><span>lanraragi  | sh: you need to specify whom to kill</span></span>
<span class="line"><span>lanraragi  | cat: can&#39;t open &#39;/home/koyomi/lanraragi/temp/minion.pid-s6&#39;: No such file or directory</span></span>
<span class="line"><span>lanraragi  | sh: you need to specify whom to kill</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>docker-compose的配置是这样的</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">services</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  lanraragi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> difegue/lanraragi</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lanraragi</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    ports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">23000:23000</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/nas/lANraragi/content:/home/koyomi/lanraragi/content</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/nas/Docker/lanraragi/thumb:/home/koyomi/lanraragi/thumb</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/nas/Docker/lanraragi/database:/home/koyomi/lanraragi/database</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unless-stopped</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="尝试一-配置容器使用权限更高的用户-无果" tabindex="-1"><a class="header-anchor" href="#尝试一-配置容器使用权限更高的用户-无果"><span>尝试一 配置容器使用权限更高的用户（无果）</span></a></h3><p>尝试为容器配置更高权限的用户，为docker-compose加入配置</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">environment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LRR_UID=1000</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LRR_GID=1000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重新运行容器后仍然报错，在使用配置root用户后依然报错</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">environment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LRR_UID=0</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LRR_GID=0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="尝试二-将thumb目录和database目录移动到新主机上-成功" tabindex="-1"><a class="header-anchor" href="#尝试二-将thumb目录和database目录移动到新主机上-成功"><span>尝试二 将thumb目录和database目录移动到新主机上（成功）</span></a></h3><p>将docker使用的thumb目录和database目录移动到新主机上后更改docker-compose配置</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/nas/lANraragi/content:/home/koyomi/lanraragi/content</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/server/docker/lanraragi/thumb:/home/koyomi/lanraragi/thumb</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/server/docker/lanraragi/database:/home/koyomi/lanraragi/database</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>再次运行容器，成功！</p><h2 id="发现漫画缩略图无法显示-重新生成封面出现permission-denied" tabindex="-1"><a class="header-anchor" href="#发现漫画缩略图无法显示-重新生成封面出现permission-denied"><span>发现漫画缩略图无法显示，重新生成封面出现Permission denied</span></a></h2><p>容器运行成功，漫画数据和tag等内容都成功加载但是封面无法正常显示。在设置中重新生成封面无效，后台出现以下错误</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>[Minion] [warn] Error while generating thumbnail: mkdir /home/koyomi/lanraragi/content/thumb/45: Permission denied at /home/koyomi/lanraragi/script/../lib/LANraragi/Utils/Archive.pm line 127.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="尝试一-为thumb目录设置权限-无果" tabindex="-1"><a class="header-anchor" href="#尝试一-为thumb目录设置权限-无果"><span>尝试一 为thumb目录设置权限（无果）</span></a></h3><p>使用<code>chown</code>和<code>chmod</code>命令设置目录的权限</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 1000:1000</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/server/docker/lanraragi/thumb</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chmod</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 775</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /path/to/server/docker/lanraragi/thumb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重新生成缩略图依然报错</p><h3 id="尝试二-解耦缩略图目录与内容目录避免嵌套权限问题" tabindex="-1"><a class="header-anchor" href="#尝试二-解耦缩略图目录与内容目录避免嵌套权限问题"><span>尝试二 解耦缩略图目录与内容目录避免嵌套权限问题</span></a></h3><p>找到lanraragi的一个<a href="https://github.com/Difegue/LANraragi/issues/953" target="_blank" rel="noopener noreferrer">issuse</a>，根据开发者给出的建议，发现在在lanraragi中缩略图路径映射的是<code>/home/koyomi/lanraragi/thumb</code>，但在lanraragi中配置的缩略图路径为<code>/home/koyomi/lanraragi/content/thumb</code></p><p>在webui中将其修改为<code>/home/koyomi/lanraragi/thumb</code>，重新运行生成缩略图，成功！</p>`,24)]))}const p=s(r,[["render",t]]),d=JSON.parse(`{"path":"/article/dnpk28mc/","title":"迁移Lanraragi后出现权限问题Permission denied","lang":"zh-CN","frontmatter":{"title":"迁移Lanraragi后出现权限问题Permission denied","createTime":"2025/06/06 12:47:59","permalink":"/article/dnpk28mc/","tags":["Lanraragi","Docker","Linux"],"description":"将lanraragi改为用另一台主机运行后出现Redis数据加载问题 原本lanraragi运行在nas上，由于近期新装了一台Mini主机作服务器，便想将服务和存储分离。在新主机上使用docker-compose拉取lanraragi的镜像出现以下错误 docker-compose的配置是这样的 尝试一 配置容器使用权限更高的用户（无果） 尝试为容器配...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"迁移Lanraragi后出现权限问题Permission denied\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-06-06T05:10:42.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://susuwoa.github.io/article/dnpk28mc/"}],["meta",{"property":"og:site_name","content":"susuwoa's blog"}],["meta",{"property":"og:title","content":"迁移Lanraragi后出现权限问题Permission denied"}],["meta",{"property":"og:description","content":"将lanraragi改为用另一台主机运行后出现Redis数据加载问题 原本lanraragi运行在nas上，由于近期新装了一台Mini主机作服务器，便想将服务和存储分离。在新主机上使用docker-compose拉取lanraragi的镜像出现以下错误 docker-compose的配置是这样的 尝试一 配置容器使用权限更高的用户（无果） 尝试为容器配..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-06T05:10:42.000Z"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:tag","content":"Lanraragi"}],["meta",{"property":"article:modified_time","content":"2025-06-06T05:10:42.000Z"}]]},"readingTime":{"minutes":1.98,"words":595},"git":{"createdTime":1749186642000,"updatedTime":1749186642000,"contributors":[{"name":"susuwoa","username":"susuwoa","email":"751159464@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/susuwoa?v=4","url":"https://github.com/susuwoa"}]},"autoDesc":true,"filePathRelative":"折腾/迁移Lanraragi后出现权限问题Permission denied.md","headers":[],"categoryList":[{"id":"83f1f3","sort":10000,"name":"折腾"}]}`);export{p as comp,d as data};
